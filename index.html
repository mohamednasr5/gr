<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>مولّد البرومبت مع التوقيع - Eng. Mohamed Hammad</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
body {
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(135deg, #0e0e10, #1c1c1e);
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 30px 10px;
  margin: 0;
  transition: background 0.5s;
}

body.light-mode {
  background: linear-gradient(135deg, #f0f0f0, #ffffff);
  color: #000;
}

h2 {
  color: #00aaff;
  margin-bottom: 20px;
  text-shadow: 1px 1px 4px #000;
  text-align: center;
}

textarea {
  width: 95%;
  max-width: 900px;
  height: 180px;
  margin-bottom: 20px;
  padding: 15px;
  border-radius: 12px;
  border: none;
  resize: none;
  font-size: 16px;
  background-color: #1c1c1e;
  color: #fff;
  box-shadow: inset 0 0 10px #000;
}

body.light-mode textarea {
  background-color: #fff;
  color: #000;
  box-shadow: inset 0 0 10px #ccc;
}

button {
  background-color: #0078ff;
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  transition: 0.3s;
  margin: 5px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
}

button:hover {
  background-color: #00c0ff;
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(0,0,0,0.4);
}

button:disabled {
  background-color: #666;
  cursor: not-allowed;
  transform: none;
}

#output {
  width: 95%;
  max-width: 900px;
  margin-top: 20px;
  padding: 15px;
  background-color: #1c1c1e;
  border-radius: 12px;
  white-space: pre-wrap;
  font-size: 15px;
  height: 220px;
  overflow-y: auto;
  box-shadow: inset 0 0 10px #000;
}

body.light-mode #output {
  background-color: #fff;
  color: #000;
  box-shadow: inset 0 0 10px #ccc;
}

.options, .style-section, .quality-section, .signature-section, .character-section, .camera-section {
  width: 95%;
  max-width: 900px;
  margin-bottom: 20px;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
}

label {
  font-size: 15px;
  display: flex;
  align-items: center;
  gap: 5px;
  cursor: pointer;
  background: #111;
  padding: 8px 12px;
  border-radius: 8px;
  transition: 0.3s;
  white-space: nowrap;
}

body.light-mode label {
  background: #eee;
  color: #000;
}

label:hover {
  background: #222;
}

body.light-mode label:hover {
  background: #ddd;
}

input[type="checkbox"] {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

.section-title {
  width: 100%;
  margin-top: 15px;
  font-weight: bold;
  color: #00aaff;
  font-size: 16px;
  border-bottom: 1px solid #00aaff;
  padding-bottom: 4px;
  margin-bottom: 10px;
  text-align: right;
}

select {
  width: 95%;
  max-width: 900px;
  padding: 10px;
  margin-bottom: 10px;
  background-color: #1c1c1e;
  color: #fff;
  border-radius: 8px;
  border: none;
}

body.light-mode select {
  background-color: #fff;
  color: #000;
}

select[multiple] {
  height: 120px;
}

.glass {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 20px;
  padding: 15px;
  margin-bottom: 20px;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

button.active {
  animation: pulse 0.6s ease-in-out;
}

.progress-bar {
  width: 95%;
  max-width: 900px;
  height: 8px;
  background: #111;
  border-radius: 4px;
  margin-top: 10px;
}

.progress {
  height: 100%;
  background: #00aaff;
  width: 0;
  transition: width 0.3s;
}

.presets {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
}

.preset-btn {
  background: #0078ff;
  padding: 8px 15px;
  border-radius: 8px;
  cursor: pointer;
}

.history-section {
  margin-top: 20px;
}

#historyList {
  list-style: none;
  padding: 0;
}

#historyList li {
  background: #1c1c1e;
  padding: 10px;
  margin-bottom: 10px;
  border-radius: 8px;
  cursor: pointer;
}

body.light-mode #historyList li {
  background: #fff;
  color: #000;
}

#charsCount {
  font-size: 14px;
  color: #aaa;
}

body.light-mode #charsCount {
  color: #555;
}

.output-actions button {
  margin: 5px;
}

#apiKeyInput {
  width: 95%;
  max-width: 900px;
  padding: 10px;
  margin-bottom: 20px;
  background-color: #1c1c1e;
  color: #fff;
  border-radius: 8px;
  border: none;
}

body.light-mode #apiKeyInput {
  background-color: #fff;
  color: #000;
}

#loading {
  display: none;
  color: #00aaff;
  font-size: 18px;
}
</style>
</head>
<body>

<header class="header glass">
  <h2><i class="fas fa-magic"></i> مولّد البرومبت الاحترافي ✨</h2>
  <div class="header-controls">
    <button id="themeToggle" onclick="toggleTheme()"><i class="fas fa-moon"></i></button>
    <button id="historyBtn" onclick="showHistory()"><i class="fas fa-history"></i> السجل</button>
  </div>
</header>

<!-- API Key Input (مخفي الآن، لكن يمكن عرضه إذا أردت) -->
<div class="api-key-section glass" style="display: none;">
  <label class="section-title">مفتاح API (من Google AI Studio)</label>
  <input type="text" id="apiKeyInput" placeholder="أدخل مفتاح API الخاص بك هنا (مجاني من https://aistudio.google.com/app/apikey)">
</div>

<!-- Quick Presets -->
<div class="presets glass">
  <button class="preset-btn" data-prompt="صورة واقعية لـ">واقعية</button>
  <button class="preset-btn" data-prompt="فن رقمي لـ">رقمي</button>
  <button class="preset-btn" data-prompt="صورة سينمائية لـ">سينمائي</button>
</div>

<!-- Enhanced Input Section -->
<div class="input-section glass">
  <textarea id="promptInput" placeholder="اكتب فكرتك الإبداعية..."></textarea>
  
  <!-- Negative Prompt -->
  <textarea id="negativePrompt" placeholder="الأشياء الممنوعة (Negative Prompt)..."></textarea>
</div>

<!-- قسم نوع الشخصية -->
<div class="character-section glass">
  <label class="section-title">نوع الشخصية 👤</label>
  <select id="characterType">
    <option value="">اختر النوع</option>
    <option value="male">ذكر 👨</option>
    <option value="female">أنثى 👩</option>
    <option value="couples">كابلز 👫</option>
    <option value="boy child">طفل 👦</option>
    <option value="girl child">طفلة 👧</option>
  </select>
</div>

<!-- قسم خواص الكاميرا -->
<div class="camera-section glass">
  <label class="section-title">خواص الكاميرا 📸</label>
  <select id="cameraProps" multiple>
    <option value="Use wide angle lens for expansive view. 🚨 Adhere strictly.">زاوية واسعة</option>
    <option value="Close-up shot focusing on details. 🚨 Adhere strictly.">زوم كلوز أب</option>
    <option value="Aerial view from drone. 🚨 Adhere strictly.">منظر جوي</option>
    <option value="Low angle shot to emphasize power. 🚨 Adhere strictly.">زاوية منخفضة</option>
    <option value="High angle shot for vulnerability. 🚨 Adhere strictly.">زاوية عالية</option>
    <option value="Dutch tilt for dramatic tension. 🚨 Adhere strictly.">إمالة هولندية</option>
  </select>
</div>

<!-- Art Style & Quality -->
<div class="style-section glass">
  <label class="section-title">النمط الفني 🎨</label>
  <select id="artStyle">
    <option value="">اختر نمط فني</option>
    <option value="in the style of cinematic photography, 8k ultra HD">🎬 سينمائي</option>
    <option value="digital art by Greg Rutkowski">🎨 روتكوفسكي</option>
    <option value="hyper realistic, photorealistic">📸 واقعي فائق</option>
  </select>
</div>

<div class="quality-section glass">
  <label class="section-title">الجودة ⭐</label>
  <select id="quality">
    <option value="8k ultra HD, highly detailed">8K ⭐⭐⭐⭐⭐</option>
    <option value="4k ultra HD">4K ⭐⭐⭐⭐</option>
    <option value="highly detailed">HD ⭐⭐⭐</option>
  </select>
</div>

<div class="options glass">
  <label><input type="checkbox" value="Do not add a beard or mustache."> 🧔 لا تضف لحية أو شارب</label>
  <label><input type="checkbox" value="Change clothes to modest dresses and a hijab that covers all of the hair, leaving no part of it visible."> 🧕 تغيير الملابس إلى فساتين محتشمة وحجاب يغطي الشعر بالكامل</label>
  <label><input type="checkbox" value="Change places, make the place different, choose a suitable and beautiful place."> 🌆 تغيير المكان، اختيار مكان مناسب وجميل</label>
  <label><input type="checkbox" value="Zoom the camera angle so the character's face appears completely and clearly."> 🎥 تكبير زاوية الكاميرا لعرض الوجه بالكامل بوضوح</label>
  <label><input type="checkbox" value="Zoom in on the person's face clearly and closely."> 🔍 زوم إن على وجه الشخص</label>
  <label><input type="checkbox" value="Zoom in to show half of the person and face in the frame."> 🧍 زوم إن نصف الشخص ووجهه</label>
  <label><input type="checkbox" value="Show the full person with background in the scene."> 🌄 الشخص كامل مع الخلفية</label>
  <label><input type="checkbox" value="Enhance lighting to be professional and dramatic."> 💡 تحسين الإضاءة</label>
  <label><input type="checkbox" value="Add background details consistent with the scene without changing original elements."> 🖼 تحسين الخلفية</label>
  <!-- خيارات جديدة -->
  <label><input type="checkbox" value="Add a simple scarf only, no full hijab. 🚨 Adhere strictly."> 🧣 طرحة فقط</label>
  <label><input type="checkbox" value="Add hijab only, covering hair completely. 🚨 Adhere strictly."> 🧕 حجاب فقط</label>
  <label><input type="checkbox" value="Change shoes to modern sneakers. 🚨 Adhere strictly."> 👟 تغيير الحذاء إلى سنيكرز</label>
  <label><input type="checkbox" value="Change shoes to formal boots. 🚨 Adhere strictly."> 👢 تغيير الحذاء إلى بوت</label>
  <label><input type="checkbox" value="Change male clothes to formal suit. 🚨 Adhere strictly."> 👔 تغيير ملابس الرجل إلى بدلة</label>
  <label><input type="checkbox" value="Change male clothes to casual t-shirt and jeans. 🚨 Adhere strictly."> 👕 تغيير ملابس الرجل إلى تيشرت عادي</label>
</div>

<!-- Signature Customizer -->
<div class="signature-section glass">
  <label class="section-title">📝 توقيع مخصص</label>
  <input type="text" id="signatureName" placeholder="اسم التوقيع" value="Eng. Mohamed Hammad">
  <input type="color" id="signatureColor" value="#FFD700">
  <select id="signatureFont">
    <option value="stylish cursive">خط فني</option>
    <option value="modern clean">خط عصري</option>
  </select>
</div>

<!-- Action Buttons -->
<div class="action-buttons">
  <button onclick="generatePromptWithAPI()" class="btn-primary"><i class="fas fa-sparkles"></i> إنشاء البرومبت عبر API</button>
  <button id="copyBtn" onclick="copyPrompt()" class="btn-secondary"><i class="fas fa-copy"></i> نسخ</button>
  <button onclick="saveTemplate()" class="btn-success"><i class="fas fa-save"></i> حفظ كقالب</button>
  <button onclick="downloadPrompt()" class="btn-info"><i class="fas fa-download"></i> تحميل</button>
</div>

<!-- Enhanced Output -->
<div class="output-section glass">
  <div class="output-header">
    <h3>📄 البرومبت النهائي</h3>
    <span id="charsCount">0/5000</span>
  </div>
  <div id="output"></div>
  <div class="output-actions">
    <button onclick="speakPrompt()"><i class="fas fa-volume-up"></i> النطق</button>
    <button onclick="sharePrompt()"><i class="fas fa-share-alt"></i> المشاركة</button>
  </div>
</div>

<!-- Loading Indicator -->
<div id="loading">جاري توليد البرومبت... <i class="fas fa-spinner fa-spin"></i></div>

<!-- Progress Bar -->
<div class="progress-bar">
  <div class="progress" id="progress"></div>
</div>

<!-- History Section -->
<div class="history-section glass" id="historySection" style="display: none;">
  <h3>📚 سجل البرومبتات</h3>
  <ul id="historyList"></ul>
</div>

<script>
// دالة توليد البرومبت عبر Google Gemini API (باستخدام المفتاح المقدم)
async function generatePromptWithAPI() {
  const apiKey = 'AIzaSyAXaZYTNOKvdhDtrN8Sy2GjNPg-am0zUL4'; // المفتاح المقدم مدمج الآن

  const promptEl = document.getElementById('promptInput');
  const negativeEl = document.getElementById('negativePrompt');
  const prompt = promptEl.value.trim();
  const negative = negativeEl.value.trim();
  const checkboxes = document.querySelectorAll('.options input[type="checkbox"]:checked');
  let selected = '';

  checkboxes.forEach(cb => {
    selected += '\n- ' + cb.value;
  });

  // نوع الشخصية
  const characterTypeEl = document.getElementById('characterType');
  if (characterTypeEl.value) {
    selected += `\n- Main character: ${characterTypeEl.value}`;
  }

  // خواص الكاميرا
  const cameraPropsEl = document.getElementById('cameraProps');
  const cameraSelected = Array.from(cameraPropsEl.selectedOptions).map(opt => opt.value);
  if (cameraSelected.length > 0) {
    selected += '\n- Camera props: ' + cameraSelected.join(', ');
  }

  // النمط الفني
  const artStyle = document.getElementById('artStyle').value;
  if (artStyle) {
    selected += `\n- Art style: ${artStyle}`;
  }

  // الجودة
  const quality = document.getElementById('quality').value;
  if (quality) {
    selected += `\n- Quality: ${quality}`;
  }

  // Negative Prompt
  let negativeText = '';
  if (negative) {
    negativeText = `\nNegative elements to avoid: ${negative}`;
  }

  // التوقيع المخصص
  const sigName = document.getElementById('signatureName').value;
  const sigColor = document.getElementById('signatureColor').value;
  const sigFont = document.getElementById('signatureFont').value;
  const signature = `\nAdd signature: '${sigName}' in ${sigFont} font, color ${sigColor}.`;

  // بناء البرومبت للـ API
  const apiPrompt = `Generate a detailed AI image generation prompt based on this user input: "${prompt}" and these specifications:${selected}${negativeText}${signature}. Make it professional and adhere to all options strictly. Start with "Use the attached images to match the face perfectly..." and end with the signature instruction.`;

  const btn = event.target;
  const loading = document.getElementById('loading');
  btn.disabled = true;
  loading.style.display = 'block';

  try {
    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        contents: [{ parts: [{ text: apiPrompt }] }]
      })
    });

    if (!response.ok) {
      throw new Error(`خطأ في الـ API: ${response.status} - تحقق من المفتاح أو الحدود.`);
    }

    const data = await response.json();
    const generatedText = data.candidates[0].content.parts[0].text.trim();

    const outputEl = document.getElementById('output');
    outputEl.textContent = generatedText;

    // تحديث عدد الحروف
    document.getElementById('charsCount').textContent = `${generatedText.length}/5000`;

    // حفظ في السجل
    addToHistory(generatedText);

    // تنظيف الإدخال
    promptEl.value = '';
    negativeEl.value = '';

    // شريط التقدم
    const progress = document.getElementById('progress');
    progress.style.width = '100%';
    setTimeout(() => { progress.style.width = '0'; }, 1000);
  } catch (error) {
    alert('خطأ في توليد البرومبت: ' + error.message + '\n(قد يكون المفتاح غير صالح أو تجاوزت الحدود. جرب مفتاحاً آخر أو انتظر.)');
  } finally {
    btn.disabled = false;
    loading.style.display = 'none';
  }
}

// دالة النسخ
function copyPrompt() {
  const output = document.getElementById('output').textContent;
  if (!output) return;
  
  navigator.clipboard.writeText(output).then(() => {
    const btn = document.getElementById('copyBtn');
    btn.style.backgroundColor = '#28a745';
    btn.textContent = 'تم النسخ ✅';
    setTimeout(() => {
      btn.style.backgroundColor = '#0078ff';
      btn.textContent = 'نسخ البرومبت';
    }, 2000);
  });
}

// حفظ كقالب
function saveTemplate() {
  const name = prompt('أدخل اسم القالب:');
  if (!name) return;
  const prompt = document.getElementById('output').textContent;
  let templates = JSON.parse(localStorage.getItem('promptTemplates') || '[]');
  templates.push({name, prompt});
  localStorage.setItem('promptTemplates', JSON.stringify(templates));
  alert('تم الحفظ!');
}

// تحميل
function downloadPrompt() {
  const output = document.getElementById('output').textContent;
  if (!output) return;
  const blob = new Blob([output], {type: 'text/plain'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'prompt.txt';
  a.click();
}

// النطق (باستخدام SpeechSynthesis)
function speakPrompt() {
  const output = document.getElementById('output').textContent;
  if (!output) return;
  const utterance = new SpeechSynthesisUtterance(output);
  utterance.lang = 'ar-SA'; // للغة العربية
  speechSynthesis.speak(utterance);
}

// مشاركة (مثالي)
function sharePrompt() {
  const output = document.getElementById('output').textContent;
  if (navigator.share) {
    navigator.share({ text: output });
  } else {
    alert('المشاركة غير مدعومة، انسخ يدوياً.');
  }
}

// Dark/Light Mode
function toggleTheme() {
  document.body.classList.toggle('light-mode');
  const icon = document.getElementById('themeToggle').querySelector('i');
  icon.classList.toggle('fa-moon');
  icon.classList.toggle('fa-sun');
}

// السجل
let history = JSON.parse(localStorage.getItem('promptHistory') || '[]');

function addToHistory(prompt) {
  history.push(prompt);
  localStorage.setItem('promptHistory', JSON.stringify(history));
}

function showHistory() {
  const section = document.getElementById('historySection');
  section.style.display = section.style.display === 'none' ? 'block' : 'none';
  const list = document.getElementById('historyList');
  list.innerHTML = '';
  history.forEach((item, index) => {
    const li = document.createElement('li');
    li.textContent = `برومبت ${index + 1}: ${item.substring(0, 50)}...`;
    li.onclick = () => {
      document.getElementById('output').textContent = item;
    };
    list.appendChild(li);
  });
}

// Quick Presets
document.querySelectorAll('.preset-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const preset = btn.dataset.prompt;
    const input = document.getElementById('promptInput');
    input.value = preset + input.value;
  });
});

// Auto-save (كل 30 ثانية)
setInterval(() => {
  const draft = document.getElementById('promptInput').value;
  if (draft) localStorage.setItem('promptDraft', draft);
}, 30000);

// تحميل الـ Draft عند التحميل
window.onload = () => {
  const draft = localStorage.getItem('promptDraft');
  if (draft) document.getElementById('promptInput').value = draft;
};

// Particles Background (مثال بسيط، يمكن توسيع)
function createParticles() {
  console.log('Particles initialized');
}
createParticles();
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…ÙˆÙ„Ù‘Ø¯ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª Ù…Ø¹ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ - Eng. Mohamed Hammad</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
body {
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(135deg, #0e0e10, #1c1c1e);
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 30px 10px;
  margin: 0;
  transition: background 0.5s;
}

body.light-mode {
  background: linear-gradient(135deg, #f0f0f0, #ffffff);
  color: #000;
}

h2 {
  color: #00aaff;
  margin-bottom: 20px;
  text-shadow: 1px 1px 4px #000;
  text-align: center;
}

textarea {
  width: 95%;
  max-width: 900px;
  height: 180px;
  margin-bottom: 20px;
  padding: 15px;
  border-radius: 12px;
  border: none;
  resize: none;
  font-size: 16px;
  background-color: #1c1c1e;
  color: #fff;
  box-shadow: inset 0 0 10px #000;
}

body.light-mode textarea {
  background-color: #fff;
  color: #000;
  box-shadow: inset 0 0 10px #ccc;
}

button {
  background-color: #0078ff;
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  transition: 0.3s;
  margin: 5px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
}

button:hover {
  background-color: #00c0ff;
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(0,0,0,0.4);
}

button:disabled {
  background-color: #666;
  cursor: not-allowed;
  transform: none;
}

#output {
  width: 95%;
  max-width: 900px;
  margin-top: 20px;
  padding: 15px;
  background-color: #1c1c1e;
  border-radius: 12px;
  white-space: pre-wrap;
  font-size: 15px;
  height: 220px;
  overflow-y: auto;
  box-shadow: inset 0 0 10px #000;
}

body.light-mode #output {
  background-color: #fff;
  color: #000;
  box-shadow: inset 0 0 10px #ccc;
}

.options, .style-section, .quality-section, .signature-section, .character-section, .camera-section {
  width: 95%;
  max-width: 900px;
  margin-bottom: 20px;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
}

label {
  font-size: 15px;
  display: flex;
  align-items: center;
  gap: 5px;
  cursor: pointer;
  background: #111;
  padding: 8px 12px;
  border-radius: 8px;
  transition: 0.3s;
  white-space: nowrap;
}

body.light-mode label {
  background: #eee;
  color: #000;
}

label:hover {
  background: #222;
}

body.light-mode label:hover {
  background: #ddd;
}

input[type="checkbox"] {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

.section-title {
  width: 100%;
  margin-top: 15px;
  font-weight: bold;
  color: #00aaff;
  font-size: 16px;
  border-bottom: 1px solid #00aaff;
  padding-bottom: 4px;
  margin-bottom: 10px;
  text-align: right;
}

select {
  width: 95%;
  max-width: 900px;
  padding: 10px;
  margin-bottom: 10px;
  background-color: #1c1c1e;
  color: #fff;
  border-radius: 8px;
  border: none;
}

body.light-mode select {
  background-color: #fff;
  color: #000;
}

select[multiple] {
  height: 120px;
}

.glass {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 20px;
  padding: 15px;
  margin-bottom: 20px;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

button.active {
  animation: pulse 0.6s ease-in-out;
}

.progress-bar {
  width: 95%;
  max-width: 900px;
  height: 8px;
  background: #111;
  border-radius: 4px;
  margin-top: 10px;
}

.progress {
  height: 100%;
  background: #00aaff;
  width: 0;
  transition: width 0.3s;
}

.presets {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
}

.preset-btn {
  background: #0078ff;
  padding: 8px 15px;
  border-radius: 8px;
  cursor: pointer;
}

.history-section {
  margin-top: 20px;
}

#historyList {
  list-style: none;
  padding: 0;
}

#historyList li {
  background: #1c1c1e;
  padding: 10px;
  margin-bottom: 10px;
  border-radius: 8px;
  cursor: pointer;
}

body.light-mode #historyList li {
  background: #fff;
  color: #000;
}

#charsCount {
  font-size: 14px;
  color: #aaa;
}

body.light-mode #charsCount {
  color: #555;
}

.output-actions button {
  margin: 5px;
}

#apiKeyInput {
  width: 95%;
  max-width: 900px;
  padding: 10px;
  margin-bottom: 20px;
  background-color: #1c1c1e;
  color: #fff;
  border-radius: 8px;
  border: none;
}

body.light-mode #apiKeyInput {
  background-color: #fff;
  color: #000;
}

#loading {
  display: none;
  color: #00aaff;
  font-size: 18px;
}
</style>
</head>
<body>

<header class="header glass">
  <h2><i class="fas fa-magic"></i> Ù…ÙˆÙ„Ù‘Ø¯ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ âœ¨</h2>
  <div class="header-controls">
    <button id="themeToggle" onclick="toggleTheme()"><i class="fas fa-moon"></i></button>
    <button id="historyBtn" onclick="showHistory()"><i class="fas fa-history"></i> Ø§Ù„Ø³Ø¬Ù„</button>
  </div>
</header>

<!-- API Key Input (Ù…Ø®ÙÙŠ Ø§Ù„Ø¢Ù†ØŒ Ù„ÙƒÙ† ÙŠÙ…ÙƒÙ† Ø¹Ø±Ø¶Ù‡ Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª) -->
<div class="api-key-section glass" style="display: none;">
  <label class="section-title">Ù…ÙØªØ§Ø­ API (Ù…Ù† Google AI Studio)</label>
  <input type="text" id="apiKeyInput" placeholder="Ø£Ø¯Ø®Ù„ Ù…ÙØªØ§Ø­ API Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§ (Ù…Ø¬Ø§Ù†ÙŠ Ù…Ù† https://aistudio.google.com/app/apikey)">
</div>

<!-- Quick Presets -->
<div class="presets glass">
  <button class="preset-btn" data-prompt="ØµÙˆØ±Ø© ÙˆØ§Ù‚Ø¹ÙŠØ© Ù„Ù€">ÙˆØ§Ù‚Ø¹ÙŠØ©</button>
  <button class="preset-btn" data-prompt="ÙÙ† Ø±Ù‚Ù…ÙŠ Ù„Ù€">Ø±Ù‚Ù…ÙŠ</button>
  <button class="preset-btn" data-prompt="ØµÙˆØ±Ø© Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠØ© Ù„Ù€">Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠ</button>
</div>

<!-- Enhanced Input Section -->
<div class="input-section glass">
  <textarea id="promptInput" placeholder="Ø§ÙƒØªØ¨ ÙÙƒØ±ØªÙƒ Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ©..."></textarea>
  
  <!-- Negative Prompt -->
  <textarea id="negativePrompt" placeholder="Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø§Ù„Ù…Ù…Ù†ÙˆØ¹Ø© (Negative Prompt)..."></textarea>
</div>

<!-- Ù‚Ø³Ù… Ù†ÙˆØ¹ Ø§Ù„Ø´Ø®ØµÙŠØ© -->
<div class="character-section glass">
  <label class="section-title">Ù†ÙˆØ¹ Ø§Ù„Ø´Ø®ØµÙŠØ© ğŸ‘¤</label>
  <select id="characterType">
    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹</option>
    <option value="male">Ø°ÙƒØ± ğŸ‘¨</option>
    <option value="female">Ø£Ù†Ø«Ù‰ ğŸ‘©</option>
    <option value="couples">ÙƒØ§Ø¨Ù„Ø² ğŸ‘«</option>
    <option value="boy child">Ø·ÙÙ„ ğŸ‘¦</option>
    <option value="girl child">Ø·ÙÙ„Ø© ğŸ‘§</option>
  </select>
</div>

<!-- Ù‚Ø³Ù… Ø®ÙˆØ§Øµ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ -->
<div class="camera-section glass">
  <label class="section-title">Ø®ÙˆØ§Øµ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ğŸ“¸</label>
  <select id="cameraProps" multiple>
    <option value="Use wide angle lens for expansive view. ğŸš¨ Adhere strictly.">Ø²Ø§ÙˆÙŠØ© ÙˆØ§Ø³Ø¹Ø©</option>
    <option value="Close-up shot focusing on details. ğŸš¨ Adhere strictly.">Ø²ÙˆÙ… ÙƒÙ„ÙˆØ² Ø£Ø¨</option>
    <option value="Aerial view from drone. ğŸš¨ Adhere strictly.">Ù…Ù†Ø¸Ø± Ø¬ÙˆÙŠ</option>
    <option value="Low angle shot to emphasize power. ğŸš¨ Adhere strictly.">Ø²Ø§ÙˆÙŠØ© Ù…Ù†Ø®ÙØ¶Ø©</option>
    <option value="High angle shot for vulnerability. ğŸš¨ Adhere strictly.">Ø²Ø§ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©</option>
    <option value="Dutch tilt for dramatic tension. ğŸš¨ Adhere strictly.">Ø¥Ù…Ø§Ù„Ø© Ù‡ÙˆÙ„Ù†Ø¯ÙŠØ©</option>
  </select>
</div>

<!-- Art Style & Quality -->
<div class="style-section glass">
  <label class="section-title">Ø§Ù„Ù†Ù…Ø· Ø§Ù„ÙÙ†ÙŠ ğŸ¨</label>
  <select id="artStyle">
    <option value="">Ø§Ø®ØªØ± Ù†Ù…Ø· ÙÙ†ÙŠ</option>
    <option value="in the style of cinematic photography, 8k ultra HD">ğŸ¬ Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠ</option>
    <option value="digital art by Greg Rutkowski">ğŸ¨ Ø±ÙˆØªÙƒÙˆÙØ³ÙƒÙŠ</option>
    <option value="hyper realistic, photorealistic">ğŸ“¸ ÙˆØ§Ù‚Ø¹ÙŠ ÙØ§Ø¦Ù‚</option>
  </select>
</div>

<div class="quality-section glass">
  <label class="section-title">Ø§Ù„Ø¬ÙˆØ¯Ø© â­</label>
  <select id="quality">
    <option value="8k ultra HD, highly detailed">8K â­â­â­â­â­</option>
    <option value="4k ultra HD">4K â­â­â­â­</option>
    <option value="highly detailed">HD â­â­â­</option>
  </select>
</div>

<div class="options glass">
  <label><input type="checkbox" value="Do not add a beard or mustache."> ğŸ§” Ù„Ø§ ØªØ¶Ù Ù„Ø­ÙŠØ© Ø£Ùˆ Ø´Ø§Ø±Ø¨</label>
  <label><input type="checkbox" value="Change clothes to modest dresses and a hijab that covers all of the hair, leaving no part of it visible."> ğŸ§• ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø¥Ù„Ù‰ ÙØ³Ø§ØªÙŠÙ† Ù…Ø­ØªØ´Ù…Ø© ÙˆØ­Ø¬Ø§Ø¨ ÙŠØºØ·ÙŠ Ø§Ù„Ø´Ø¹Ø± Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</label>
  <label><input type="checkbox" value="Change places, make the place different, choose a suitable and beautiful place."> ğŸŒ† ØªØºÙŠÙŠØ± Ø§Ù„Ù…ÙƒØ§Ù†ØŒ Ø§Ø®ØªÙŠØ§Ø± Ù…ÙƒØ§Ù† Ù…Ù†Ø§Ø³Ø¨ ÙˆØ¬Ù…ÙŠÙ„</label>
  <label><input type="checkbox" value="Zoom the camera angle so the character's face appears completely and clearly."> ğŸ¥ ØªÙƒØ¨ÙŠØ± Ø²Ø§ÙˆÙŠØ© Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù„Ø¹Ø±Ø¶ Ø§Ù„ÙˆØ¬Ù‡ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨ÙˆØ¶ÙˆØ­</label>
  <label><input type="checkbox" value="Zoom in on the person's face clearly and closely."> ğŸ” Ø²ÙˆÙ… Ø¥Ù† Ø¹Ù„Ù‰ ÙˆØ¬Ù‡ Ø§Ù„Ø´Ø®Øµ</label>
  <label><input type="checkbox" value="Zoom in to show half of the person and face in the frame."> ğŸ§ Ø²ÙˆÙ… Ø¥Ù† Ù†ØµÙ Ø§Ù„Ø´Ø®Øµ ÙˆÙˆØ¬Ù‡Ù‡</label>
  <label><input type="checkbox" value="Show the full person with background in the scene."> ğŸŒ„ Ø§Ù„Ø´Ø®Øµ ÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø®Ù„ÙÙŠØ©</label>
  <label><input type="checkbox" value="Enhance lighting to be professional and dramatic."> ğŸ’¡ ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø©</label>
  <label><input type="checkbox" value="Add background details consistent with the scene without changing original elements."> ğŸ–¼ ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø®Ù„ÙÙŠØ©</label>
  <!-- Ø®ÙŠØ§Ø±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© -->
  <label><input type="checkbox" value="Add a simple scarf only, no full hijab. ğŸš¨ Adhere strictly."> ğŸ§£ Ø·Ø±Ø­Ø© ÙÙ‚Ø·</label>
  <label><input type="checkbox" value="Add hijab only, covering hair completely. ğŸš¨ Adhere strictly."> ğŸ§• Ø­Ø¬Ø§Ø¨ ÙÙ‚Ø·</label>
  <label><input type="checkbox" value="Change shoes to modern sneakers. ğŸš¨ Adhere strictly."> ğŸ‘Ÿ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø°Ø§Ø¡ Ø¥Ù„Ù‰ Ø³Ù†ÙŠÙƒØ±Ø²</label>
  <label><input type="checkbox" value="Change shoes to formal boots. ğŸš¨ Adhere strictly."> ğŸ‘¢ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø°Ø§Ø¡ Ø¥Ù„Ù‰ Ø¨ÙˆØª</label>
  <label><input type="checkbox" value="Change male clothes to formal suit. ğŸš¨ Adhere strictly."> ğŸ‘” ØªØºÙŠÙŠØ± Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ø±Ø¬Ù„ Ø¥Ù„Ù‰ Ø¨Ø¯Ù„Ø©</label>
  <label><input type="checkbox" value="Change male clothes to casual t-shirt and jeans. ğŸš¨ Adhere strictly."> ğŸ‘• ØªØºÙŠÙŠØ± Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ø±Ø¬Ù„ Ø¥Ù„Ù‰ ØªÙŠØ´Ø±Øª Ø¹Ø§Ø¯ÙŠ</label>
</div>

<!-- Signature Customizer -->
<div class="signature-section glass">
  <label class="section-title">ğŸ“ ØªÙˆÙ‚ÙŠØ¹ Ù…Ø®ØµØµ</label>
  <input type="text" id="signatureName" placeholder="Ø§Ø³Ù… Ø§Ù„ØªÙˆÙ‚ÙŠØ¹" value="Eng. Mohamed Hammad">
  <input type="color" id="signatureColor" value="#FFD700">
  <select id="signatureFont">
    <option value="stylish cursive">Ø®Ø· ÙÙ†ÙŠ</option>
    <option value="modern clean">Ø®Ø· Ø¹ØµØ±ÙŠ</option>
  </select>
</div>

<!-- Action Buttons -->
<div class="action-buttons">
  <button onclick="generatePromptWithAPI()" class="btn-primary"><i class="fas fa-sparkles"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª Ø¹Ø¨Ø± API</button>
  <button id="copyBtn" onclick="copyPrompt()" class="btn-secondary"><i class="fas fa-copy"></i> Ù†Ø³Ø®</button>
  <button onclick="saveTemplate()" class="btn-success"><i class="fas fa-save"></i> Ø­ÙØ¸ ÙƒÙ‚Ø§Ù„Ø¨</button>
  <button onclick="downloadPrompt()" class="btn-info"><i class="fas fa-download"></i> ØªØ­Ù…ÙŠÙ„</button>
</div>

<!-- Enhanced Output -->
<div class="output-section glass">
  <div class="output-header">
    <h3>ğŸ“„ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</h3>
    <span id="charsCount">0/5000</span>
  </div>
  <div id="output"></div>
  <div class="output-actions">
    <button onclick="speakPrompt()"><i class="fas fa-volume-up"></i> Ø§Ù„Ù†Ø·Ù‚</button>
    <button onclick="sharePrompt()"><i class="fas fa-share-alt"></i> Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©</button>
  </div>
</div>

<!-- Loading Indicator -->
<div id="loading">Ø¬Ø§Ø±ÙŠ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª... <i class="fas fa-spinner fa-spin"></i></div>

<!-- Progress Bar -->
<div class="progress-bar">
  <div class="progress" id="progress"></div>
</div>

<!-- History Section -->
<div class="history-section glass" id="historySection" style="display: none;">
  <h3>ğŸ“š Ø³Ø¬Ù„ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª</h3>
  <ul id="historyList"></ul>
</div>

<script>
// Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª Ø¹Ø¨Ø± Google Gemini API (Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ù‚Ø¯Ù…)
async function generatePromptWithAPI() {
  const apiKey = 'AIzaSyAXaZYTNOKvdhDtrN8Sy2GjNPg-am0zUL4'; // Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ù‚Ø¯Ù… Ù…Ø¯Ù…Ø¬ Ø§Ù„Ø¢Ù†

  const promptEl = document.getElementById('promptInput');
  const negativeEl = document.getElementById('negativePrompt');
  const prompt = promptEl.value.trim();
  const negative = negativeEl.value.trim();
  const checkboxes = document.querySelectorAll('.options input[type="checkbox"]:checked');
  let selected = '';

  checkboxes.forEach(cb => {
    selected += '\n- ' + cb.value;
  });

  // Ù†ÙˆØ¹ Ø§Ù„Ø´Ø®ØµÙŠØ©
  const characterTypeEl = document.getElementById('characterType');
  if (characterTypeEl.value) {
    selected += `\n- Main character: ${characterTypeEl.value}`;
  }

  // Ø®ÙˆØ§Øµ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
  const cameraPropsEl = document.getElementById('cameraProps');
  const cameraSelected = Array.from(cameraPropsEl.selectedOptions).map(opt => opt.value);
  if (cameraSelected.length > 0) {
    selected += '\n- Camera props: ' + cameraSelected.join(', ');
  }

  // Ø§Ù„Ù†Ù…Ø· Ø§Ù„ÙÙ†ÙŠ
  const artStyle = document.getElementById('artStyle').value;
  if (artStyle) {
    selected += `\n- Art style: ${artStyle}`;
  }

  // Ø§Ù„Ø¬ÙˆØ¯Ø©
  const quality = document.getElementById('quality').value;
  if (quality) {
    selected += `\n- Quality: ${quality}`;
  }

  // Negative Prompt
  let negativeText = '';
  if (negative) {
    negativeText = `\nNegative elements to avoid: ${negative}`;
  }

  // Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø®ØµØµ
  const sigName = document.getElementById('signatureName').value;
  const sigColor = document.getElementById('signatureColor').value;
  const sigFont = document.getElementById('signatureFont').value;
  const signature = `\nAdd signature: '${sigName}' in ${sigFont} font, color ${sigColor}.`;

  // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª Ù„Ù„Ù€ API
  const apiPrompt = `Generate a detailed AI image generation prompt based on this user input: "${prompt}" and these specifications:${selected}${negativeText}${signature}. Make it professional and adhere to all options strictly. Start with "Use the attached images to match the face perfectly..." and end with the signature instruction.`;

  const btn = event.target;
  const loading = document.getElementById('loading');
  btn.disabled = true;
  loading.style.display = 'block';

  try {
    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        contents: [{ parts: [{ text: apiPrompt }] }]
      })
    });

    if (!response.ok) {
      throw new Error(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù€ API: ${response.status} - ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ÙØªØ§Ø­ Ø£Ùˆ Ø§Ù„Ø­Ø¯ÙˆØ¯.`);
    }

    const data = await response.json();
    const generatedText = data.candidates[0].content.parts[0].text.trim();

    const outputEl = document.getElementById('output');
    outputEl.textContent = generatedText;

    // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø±ÙˆÙ
    document.getElementById('charsCount').textContent = `${generatedText.length}/5000`;

    // Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø³Ø¬Ù„
    addToHistory(generatedText);

    // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
    promptEl.value = '';
    negativeEl.value = '';

    // Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
    const progress = document.getElementById('progress');
    progress.style.width = '100%';
    setTimeout(() => { progress.style.width = '0'; }, 1000);
  } catch (error) {
    alert('Ø®Ø·Ø£ ÙÙŠ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª: ' + error.message + '\n(Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ù„Ù…ÙØªØ§Ø­ ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ ØªØ¬Ø§ÙˆØ²Øª Ø§Ù„Ø­Ø¯ÙˆØ¯. Ø¬Ø±Ø¨ Ù…ÙØªØ§Ø­Ø§Ù‹ Ø¢Ø®Ø± Ø£Ùˆ Ø§Ù†ØªØ¸Ø±.)');
  } finally {
    btn.disabled = false;
    loading.style.display = 'none';
  }
}

// Ø¯Ø§Ù„Ø© Ø§Ù„Ù†Ø³Ø®
function copyPrompt() {
  const output = document.getElementById('output').textContent;
  if (!output) return;
  
  navigator.clipboard.writeText(output).then(() => {
    const btn = document.getElementById('copyBtn');
    btn.style.backgroundColor = '#28a745';
    btn.textContent = 'ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ…';
    setTimeout(() => {
      btn.style.backgroundColor = '#0078ff';
      btn.textContent = 'Ù†Ø³Ø® Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª';
    }, 2000);
  });
}

// Ø­ÙØ¸ ÙƒÙ‚Ø§Ù„Ø¨
function saveTemplate() {
  const name = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ø§Ù„Ø¨:');
  if (!name) return;
  const prompt = document.getElementById('output').textContent;
  let templates = JSON.parse(localStorage.getItem('promptTemplates') || '[]');
  templates.push({name, prompt});
  localStorage.setItem('promptTemplates', JSON.stringify(templates));
  alert('ØªÙ… Ø§Ù„Ø­ÙØ¸!');
}

// ØªØ­Ù…ÙŠÙ„
function downloadPrompt() {
  const output = document.getElementById('output').textContent;
  if (!output) return;
  const blob = new Blob([output], {type: 'text/plain'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'prompt.txt';
  a.click();
}

// Ø§Ù„Ù†Ø·Ù‚ (Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… SpeechSynthesis)
function speakPrompt() {
  const output = document.getElementById('output').textContent;
  if (!output) return;
  const utterance = new SpeechSynthesisUtterance(output);
  utterance.lang = 'ar-SA'; // Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
  speechSynthesis.speak(utterance);
}

// Ù…Ø´Ø§Ø±ÙƒØ© (Ù…Ø«Ø§Ù„ÙŠ)
function sharePrompt() {
  const output = document.getElementById('output').textContent;
  if (navigator.share) {
    navigator.share({ text: output });
  } else {
    alert('Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø©ØŒ Ø§Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠØ§Ù‹.');
  }
}

// Dark/Light Mode
function toggleTheme() {
  document.body.classList.toggle('light-mode');
  const icon = document.getElementById('themeToggle').querySelector('i');
  icon.classList.toggle('fa-moon');
  icon.classList.toggle('fa-sun');
}

// Ø§Ù„Ø³Ø¬Ù„
let history = JSON.parse(localStorage.getItem('promptHistory') || '[]');

function addToHistory(prompt) {
  history.push(prompt);
  localStorage.setItem('promptHistory', JSON.stringify(history));
}

function showHistory() {
  const section = document.getElementById('historySection');
  section.style.display = section.style.display === 'none' ? 'block' : 'none';
  const list = document.getElementById('historyList');
  list.innerHTML = '';
  history.forEach((item, index) => {
    const li = document.createElement('li');
    li.textContent = `Ø¨Ø±ÙˆÙ…Ø¨Øª ${index + 1}: ${item.substring(0, 50)}...`;
    li.onclick = () => {
      document.getElementById('output').textContent = item;
    };
    list.appendChild(li);
  });
}

// Quick Presets
document.querySelectorAll('.preset-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const preset = btn.dataset.prompt;
    const input = document.getElementById('promptInput');
    input.value = preset + input.value;
  });
});

// Auto-save (ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©)
setInterval(() => {
  const draft = document.getElementById('promptInput').value;
  if (draft) localStorage.setItem('promptDraft', draft);
}, 30000);

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù€ Draft Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
window.onload = () => {
  const draft = localStorage.getItem('promptDraft');
  if (draft) document.getElementById('promptInput').value = draft;
};

// Particles Background (Ù…Ø«Ø§Ù„ Ø¨Ø³ÙŠØ·ØŒ ÙŠÙ…ÙƒÙ† ØªÙˆØ³ÙŠØ¹)
function createParticles() {
  console.log('Particles initialized');
}
createParticles();
</script>

</body>
</html>